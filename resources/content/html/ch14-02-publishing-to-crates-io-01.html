<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Making Useful Documentation Comments</title>
</head>
<body>
<h1>Making Useful Documentation Comments</h1>
<p>Accurately documenting your packages will help other users know how and when to
use them, so it’s worth investing the time to write documentation. In Chapter
3, we discussed how to comment Rust code using two slashes, <code>//</code>. Rust also has
a particular kind of comment for documentation, known conveniently as a
<em>documentation comment</em>, that will generate HTML documentation. The HTML
displays the contents of documentation comments for public API items intended
for programmers interested in knowing how to <em>use</em> your crate as opposed to how
your crate is <em>implemented</em>.</p>
<p>Documentation comments use three slashes, <code>///</code>, instead of two and support
Markdown notation for formatting the text. Place documentation comments just
before the item they’re documenting. Listing 14-1 shows documentation comments
for an <code>add_one</code> function in a crate named <code>my_crate</code>.</p>
<p><Listing number="14-1" file-name="src/lib.rs" caption="A documentation comment for a function"></p>
<p>```rust,ignore
{{#rustdoc_include ../listings/ch14-more-about-cargo/listing-14-01/src/lib.rs}}</p>
<pre><code>
&lt;/Listing&gt;

Here, we give a description of what the `add_one` function does, start a
section with the heading `Examples`, and then provide code that demonstrates
how to use the `add_one` function. We can generate the HTML documentation from
this documentation comment by running `cargo doc`. This command runs the
`rustdoc` tool distributed with Rust and puts the generated HTML documentation
in the _target/doc_ directory.

For convenience, running `cargo doc --open` will build the HTML for your
current crate’s documentation (as well as the documentation for all of your
crate’s dependencies) and open the result in a web browser. Navigate to the
`add_one` function and you’ll see how the text in the documentation comments is
rendered, as shown in Figure 14-1.

&lt;img alt=&quot;Rendered HTML documentation for the `add_one` function of `my_crate`&quot; src=&quot;img/trpl14-01.png&quot; class=&quot;center&quot; /&gt;

&lt;span class=&quot;caption&quot;&gt;Figure 14-1: The HTML documentation for the `add_one`
function&lt;/span&gt;

#### Commonly Used Sections

We used the `# Examples` Markdown heading in Listing 14-1 to create a section
in the HTML with the title “Examples.” Here are some other sections that crate
authors commonly use in their documentation:

- **Panics**: These are the scenarios in which the function being documented
  could panic. Callers of the function who don’t want their programs to panic
  should make sure they don’t call the function in these situations.
- **Errors**: If the function returns a `Result`, describing the kinds of
  errors that might occur and what conditions might cause those errors to be
  returned can be helpful to callers so that they can write code to handle the
  different kinds of errors in different ways.
- **Safety**: If the function is `unsafe` to call (we discuss unsafety in
  Chapter 20), there should be a section explaining why the function is unsafe
  and covering the invariants that the function expects callers to uphold.

Most documentation comments don’t need all of these sections, but this is a
good checklist to remind you of the aspects of your code users will be
interested in knowing about.

#### Documentation Comments as Tests

Adding example code blocks in your documentation comments can help demonstrate
how to use your library and has an additional bonus: Running `cargo test` will
run the code examples in your documentation as tests! Nothing is better than
documentation with examples. But nothing is worse than examples that don’t work
because the code has changed since the documentation was written. If we run
`cargo test` with the documentation for the `add_one` function from Listing
14-1, we will see a section in the test results that looks like this:

&lt;!-- manual-regeneration
cd listings/ch14-more-about-cargo/listing-14-01/
cargo test
copy just the doc-tests section below
--&gt;

```text
   Doc-tests my_crate

running 1 test
test src/lib.rs - add_one (line 5) ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.27s
</code></pre>
<p>Now, if we change either the function or the example so that the <code>assert_eq!</code>
in the example panics, and run <code>cargo test</code> again, we’ll see that the doc tests
catch that the example and the code are out of sync with each other!</p>
<!-- Old headings. Do not remove or links may break. -->

<p><a id="commenting-contained-items"></a></p>
<h4>Contained Item Comments</h4>
<p>The style of doc comment <code>//!</code> adds documentation to the item that <em>contains</em>
the comments rather than to the items <em>following</em> the comments. We typically
use these doc comments inside the crate root file (<em>src/lib.rs</em> by convention)
or inside a module to document the crate or the module as a whole.</p>
<p>For example, to add documentation that describes the purpose of the <code>my_crate</code>
crate that contains the <code>add_one</code> function, we add documentation comments that
start with <code>//!</code> to the beginning of the <em>src/lib.rs</em> file, as shown in Listing
14-2.</p>
<p><Listing number="14-2" file-name="src/lib.rs" caption="The documentation for the <code>my_crate</code> crate as a whole"></p>
<p><code>rust,ignore
{{#rustdoc_include ../listings/ch14-more-about-cargo/listing-14-02/src/lib.rs:here}}</code></p>
<p></Listing></p>
<p>Notice there isn’t any code after the last line that begins with <code>//!</code>. Because
we started the comments with <code>//!</code> instead of <code>///</code>, we’re documenting the item
that contains this comment rather than an item that follows this comment. In
this case, that item is the <em>src/lib.rs</em> file, which is the crate root. These
comments describe the entire crate.</p>
<p>When we run <code>cargo doc --open</code>, these comments will display on the front page
of the documentation for <code>my_crate</code> above the list of public items in the
crate, as shown in Figure 14-2.</p>
<p>Documentation comments within items are useful for describing crates and
modules especially. Use them to explain the overall purpose of the container to
help your users understand the crate’s organization.</p>
<p><img alt="Rendered HTML documentation with a comment for the crate as a whole" src="img/trpl14-02.png" class="center" /></p>
<p><span class="caption">Figure 14-2: The rendered documentation for <code>my_crate</code>,
including the comment describing the crate as a whole</span></p>
<!-- Old headings. Do not remove or links may break. -->

<p><a id="exporting-a-convenient-public-api-with-pub-use"></a></p>
</body>
</html>